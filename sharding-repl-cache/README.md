# MongoDB Sharded Cluster —Å –†–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π –∏ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∞:

1. **Config Server Replica Set** (1 —É–∑–µ–ª)
   - `configsvr:27019` - —Ö—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ (–≤ —Ä–µ–∂–∏–º–µ replica set)

2. **Shard 1 Replica Set** (3 —É–∑–ª–∞)
   - `shard1_primary:27018` (Primary, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 10)
   - `shard1_secondary1:27018` (Secondary, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5)
   - `shard1_secondary2:27018` (Secondary, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

3. **Shard 2 Replica Set** (3 —É–∑–ª–∞) 
   - `shard2_primary:27020` (Primary, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 10)
   - `shard2_secondary1:27020` (Secondary, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5)
   - `shard2_secondary2:27020` (Secondary, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)

4. **MongoDB Router** (mongos)
   - `mongos:27017` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

5. **Redis Cache**
   - `redis:6379` - —Å–∏—Å—Ç–µ–º–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

6. **API Application**
   - `pymongo_api:8080` - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ –∫–ª–∞—Å—Ç–µ—Ä–∞

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (7 —É–∑–ª–æ–≤ MongoDB + mongos + Redis + API)
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose ps
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞

```bash
./scripts/mongo-init.sh
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

#### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–û—Å–Ω–æ–≤–Ω–æ–π API**: http://localhost:8080
- **Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: http://localhost:8080/docs

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (–º–µ–¥–ª–µ–Ω–Ω—ã–π ~1 —Å–µ–∫—É–Ω–¥–∞)
time curl -s http://localhost:8080/helloDoc/users | head -20

# –í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å (–±—ã—Å—Ç—Ä—ã–π <100–º—Å –∏–∑ –∫–µ—à–∞)
time curl -s http://localhost:8080/helloDoc/users | head -20
```